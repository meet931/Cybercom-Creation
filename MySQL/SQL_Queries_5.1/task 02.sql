-- 2. Write a SQL query to retrieve the names of all employees who have sold more than $100,000 worth of products in the "order_details" table, sorted by the amount 
--    sold in descending order.

CREATE TABLE EMPLOYEES (
    EMPLOYEE_ID INT PRIMARY KEY,
    EMPLOYEE_NAME VARCHAR(50)
);

CREATE TABLE ORDER_DETAILST2 (
    ORDER_ID INT PRIMARY KEY,
    EMPLOYEE_ID INT,
    AMOUNT DECIMAL(10, 2),
    FOREIGN KEY (EMPLOYEE_ID) REFERENCES EMPLOYEES(EMPLOYEE_ID)
);

INSERT INTO EMPLOYEES (EMPLOYEE_ID, EMPLOYEE_NAME) VALUES
(1, 'John'),
(2, 'Alice'),
(3, 'Bob'),
(4, 'Eve');

INSERT INTO ORDER_DETAILST2 (ORDER_ID, EMPLOYEE_ID, AMOUNT) VALUES
(101, 1, 120000.00),
(102, 2, 95000.00),
(103, 3, 130000.00),
(104, 1, 80000.00),
(105, 4, 110000.00),
(106, 2, 105000.00),
(107, 1, 140000.00),
(108, 3, 90000.00),
(109, 4, 115000.00),
(110, 2, 125000.00);

SELECT * FROM EMPLOYEES;
SELECT * FROM ORDER_DETAILST2;

SELECT E.EMPLOYEE_NAME, COUNT(O.EMPLOYEE_ID) AS 'TOTAL ORDERS', SUM(O.AMOUNT) AS 'TOTAL PRICE' FROM EMPLOYEES E
LEFT JOIN ORDER_DETAILST2 O ON E.EMPLOYEE_ID = O.EMPLOYEE_ID
GROUP BY E.EMPLOYEE_NAME
HAVING SUM(O.AMOUNT) > 100000
ORDER BY SUM(O.AMOUNT) DESC;