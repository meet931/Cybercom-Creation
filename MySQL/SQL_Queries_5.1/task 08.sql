-- 8. Write a SQL query to retrieve the names of all customers who have made orders in the "orders" table, but have not made any orders for products in the "products" table 
--    with a price greater than $100.

CREATE TABLE CUSTOMERST8 (
    CUSTOMER_ID INT PRIMARY KEY,
    CUSTOMER_NAME VARCHAR(100)
);

CREATE TABLE PRODUCTST8 (
    PRODUCT_ID INT PRIMARY KEY,
    PRODUCT_NAME VARCHAR(100),
    PRICE DECIMAL(10, 2)
);

CREATE TABLE ORDERST8 (
    ORDER_ID INT PRIMARY KEY,
    CUSTOMER_ID INT,
    PRODUCT_ID INT,
    ORDER_DATE DATE,
    FOREIGN KEY (CUSTOMER_ID) REFERENCES CUSTOMERST8(CUSTOMER_ID),
    FOREIGN KEY (PRODUCT_ID) REFERENCES PRODUCTST8(PRODUCT_ID)
);

INSERT INTO CUSTOMERST8 (CUSTOMER_ID, CUSTOMER_NAME) VALUES
(1, 'CUSTOMER A'),
(2, 'CUSTOMER B'),
(3, 'CUSTOMER C'),
(4, 'CUSTOMER D'),
(5, 'CUSTOMER E'),
(6, 'CUSTOMER F'),
(7, 'CUSTOMER G'),
(8, 'CUSTOMER H'),
(9, 'CUSTOMER I'),
(10, 'CUSTOMER J');

INSERT INTO PRODUCTST8 (PRODUCT_ID, PRODUCT_NAME, PRICE) VALUES
(1, 'PRODUCT A', 50.00),
(2, 'PRODUCT B', 150.00),
(3, 'PRODUCT C', 80.00),
(4, 'PRODUCT D', 120.00),
(5, 'PRODUCT E', 90.00),
(6, 'PRODUCT F', 110.00),
(7, 'PRODUCT G', 70.00),
(8, 'PRODUCT H', 130.00),
(9, 'PRODUCT I', 40.00),
(10, 'PRODUCT J', 200.00);

INSERT INTO ORDERST8 (ORDER_ID, CUSTOMER_ID, PRODUCT_ID, ORDER_DATE) VALUES
(1, 1, 1, '2024-03-01'),
(2, 2, 2, '2024-03-02'),
(3, 3, 3, '2024-03-03'),
(4, 4, 4, '2024-03-04'),
(5, 5, 5, '2024-03-05'),
(6, 6, 6, '2024-03-06'),
(7, 7, 7, '2024-03-07'),
(8, 8, 8, '2024-03-08'),
(9, 9, 9, '2024-03-09'),
(10, 10, 10, '2024-03-10'),
(11, 1, 2, '2024-03-11'),
(12, 2, 3, '2024-03-12'),
(13, 3, 4, '2024-03-13'),
(14, 4, 5, '2024-03-14'),
(15, 5, 6, '2024-03-15'),
(16, 6, 7, '2024-03-16'),
(17, 7, 8, '2024-03-17'),
(18, 8, 9, '2024-03-18'),
(19, 9, 10, '2024-03-19'),
(20, 10, 1, '2024-03-20');

SELECT * FROM CUSTOMERST8;
SELECT * FROM ORDERST8;
SELECT * FROM PRODUCTST8;


SELECT DISTINCT C.CUSTOMER_NAME FROM CUSTOMERST8 C
JOIN ORDERST8 O ON C.CUSTOMER_ID = O.CUSTOMER_ID
LEFT JOIN PRODUCTST8 P ON O.PRODUCT_ID = P.PRODUCT_ID AND P.PRICE > 100
WHERE P.PRODUCT_ID IS NULL;
